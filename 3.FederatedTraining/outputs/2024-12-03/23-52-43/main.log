[2024-12-03 23:52:43,683][flwr][WARNING] - DEPRECATED FEATURE: flwr.simulation.start_simulation() is deprecated.
	Instead, use the `flwr run` CLI command to start a local simulation in your Flower app, as shown for example below:

		$ flwr new  # Create a new Flower app from a template

		$ flwr run  # Run the Flower app in Simulation Mode

	Using `start_simulation()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[2024-12-03 23:52:43,690][flwr][INFO] - Starting Flower simulation, config: num_rounds=10, no round_timeout
[2024-12-03 23:52:55,321][flwr][INFO] - Flower VCE: Ray initialized with resources: {'accelerator_type:G': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'memory': 3240864155.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 1620432076.0, 'GPU': 1.0}
[2024-12-03 23:52:55,322][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-03 23:52:55,322][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0.5}
[2024-12-03 23:52:55,339][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 2 actors
[2024-12-03 23:52:55,340][flwr][INFO] - [INIT]
[2024-12-03 23:52:55,340][flwr][INFO] - Using initial global parameters provided by strategy
[2024-12-03 23:52:55,341][flwr][INFO] - Starting evaluation of initial global parameters
[2024-12-03 23:53:07,463][flwr][INFO] - initial parameters (loss, other metrics): 0.146649569272995, {'mae': 0.3409636616706848}
[2024-12-03 23:53:07,463][flwr][INFO] - 
[2024-12-03 23:53:07,465][flwr][INFO] - [ROUND 1]
[2024-12-03 23:53:07,465][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:10,985][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:53:10,993][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:53:10,998][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:53:21,219][flwr][INFO] - fit progress: (1, 0.146649569272995, {'mae': 0.3409636616706848}, 13.755963900000005)
[2024-12-03 23:53:21,220][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:23,245][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:53:23,262][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:53:23,269][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:53:23,270][flwr][INFO] - 
[2024-12-03 23:53:23,270][flwr][INFO] - [ROUND 2]
[2024-12-03 23:53:23,271][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:25,101][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:53:25,110][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:53:25,115][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:53:34,726][flwr][INFO] - fit progress: (2, 0.146649569272995, {'mae': 0.3409636616706848}, 27.2615719)
[2024-12-03 23:53:34,726][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:36,848][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:53:36,857][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:53:36,864][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:53:36,864][flwr][INFO] - 
[2024-12-03 23:53:36,865][flwr][INFO] - [ROUND 3]
[2024-12-03 23:53:36,866][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:38,759][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:53:38,771][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:53:38,777][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:53:49,092][flwr][INFO] - fit progress: (3, 0.146649569272995, {'mae': 0.3409636616706848}, 41.62801480000001)
[2024-12-03 23:53:49,093][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:51,135][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:53:51,145][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:53:51,150][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:53:51,151][flwr][INFO] - 
[2024-12-03 23:53:51,151][flwr][INFO] - [ROUND 4]
[2024-12-03 23:53:51,152][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:53:53,205][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:53:53,216][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:53:53,224][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:54:02,974][flwr][INFO] - fit progress: (4, 0.146649569272995, {'mae': 0.3409636616706848}, 55.5097848)
[2024-12-03 23:54:02,975][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:04,798][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:54:04,807][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:54:04,813][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:54:04,813][flwr][INFO] - 
[2024-12-03 23:54:04,814][flwr][INFO] - [ROUND 5]
[2024-12-03 23:54:04,814][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:06,797][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:54:06,806][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:54:06,811][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:54:17,180][flwr][INFO] - fit progress: (5, 0.146649569272995, {'mae': 0.3409636616706848}, 69.7159183)
[2024-12-03 23:54:17,181][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:19,086][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:54:19,099][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:54:19,106][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:54:19,106][flwr][INFO] - 
[2024-12-03 23:54:19,107][flwr][INFO] - [ROUND 6]
[2024-12-03 23:54:19,108][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:21,010][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:54:21,019][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:54:21,025][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:54:30,805][flwr][INFO] - fit progress: (6, 0.146649569272995, {'mae': 0.3409636616706848}, 83.34049770000001)
[2024-12-03 23:54:30,805][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:32,843][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:54:32,853][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:54:32,888][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:54:32,889][flwr][INFO] - 
[2024-12-03 23:54:32,890][flwr][INFO] - [ROUND 7]
[2024-12-03 23:54:32,891][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:34,657][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:54:34,666][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:54:34,672][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:54:44,538][flwr][INFO] - fit progress: (7, 0.146649569272995, {'mae': 0.3409636616706848}, 97.0743717)
[2024-12-03 23:54:44,539][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:46,485][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:54:46,496][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:54:46,502][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:54:46,502][flwr][INFO] - 
[2024-12-03 23:54:46,503][flwr][INFO] - [ROUND 8]
[2024-12-03 23:54:46,503][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:48,346][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:54:48,354][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:54:48,359][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:54:57,656][flwr][INFO] - fit progress: (8, 0.146649569272995, {'mae': 0.3409636616706848}, 110.19265200000001)
[2024-12-03 23:54:57,657][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:54:59,754][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:54:59,764][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:54:59,771][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:54:59,772][flwr][INFO] - 
[2024-12-03 23:54:59,772][flwr][INFO] - [ROUND 9]
[2024-12-03 23:54:59,773][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:55:01,738][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:55:01,749][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:55:01,755][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:55:11,749][flwr][INFO] - fit progress: (9, 0.146649569272995, {'mae': 0.3409636616706848}, 124.28549910000001)
[2024-12-03 23:55:11,750][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:55:13,606][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:55:13,616][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:55:13,624][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:55:13,625][flwr][INFO] - 
[2024-12-03 23:55:13,626][flwr][INFO] - [ROUND 10]
[2024-12-03 23:55:13,627][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-03 23:55:15,865][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'

[2024-12-03 23:55:15,874][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 28, in fit
    weights = parameters_to_ndarrays(parameters)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\common\parameter.py", line 34, in parameters_to_ndarrays
    return [bytes_to_ndarray(tensor) for tensor in parameters.tensors]
AttributeError: 'list' object has no attribute 'tensors'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'list' object has no attribute 'tensors'
[2024-12-03 23:55:15,880][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-03 23:55:25,507][flwr][INFO] - fit progress: (10, 0.146649569272995, {'mae': 0.3409636616706848}, 138.04401479999999)
[2024-12-03 23:55:25,509][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-03 23:55:27,367][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-03 23:55:27,375][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 42, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10664, ip=127.0.0.1, actor_id=29b46d37eca1c4ef9c8c4c3201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000207CBBA1970>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-03 23:55:27,382][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-03 23:55:27,383][flwr][INFO] - 
[2024-12-03 23:55:27,383][flwr][INFO] - [SUMMARY]
[2024-12-03 23:55:27,383][flwr][INFO] - Run finished 10 round(s) in 139.92s
[2024-12-03 23:55:27,384][flwr][INFO] - 	History (loss, centralized):
[2024-12-03 23:55:27,385][flwr][INFO] - 		round 0: 0.146649569272995
[2024-12-03 23:55:27,386][flwr][INFO] - 		round 1: 0.146649569272995
[2024-12-03 23:55:27,386][flwr][INFO] - 		round 2: 0.146649569272995
[2024-12-03 23:55:27,387][flwr][INFO] - 		round 3: 0.146649569272995
[2024-12-03 23:55:27,387][flwr][INFO] - 		round 4: 0.146649569272995
[2024-12-03 23:55:27,387][flwr][INFO] - 		round 5: 0.146649569272995
[2024-12-03 23:55:27,388][flwr][INFO] - 		round 6: 0.146649569272995
[2024-12-03 23:55:27,388][flwr][INFO] - 		round 7: 0.146649569272995
[2024-12-03 23:55:27,389][flwr][INFO] - 		round 8: 0.146649569272995
[2024-12-03 23:55:27,389][flwr][INFO] - 		round 9: 0.146649569272995
[2024-12-03 23:55:27,389][flwr][INFO] - 		round 10: 0.146649569272995
[2024-12-03 23:55:27,390][flwr][INFO] - 	History (metrics, centralized):
[2024-12-03 23:55:27,390][flwr][INFO] - 	{'mae': [(0, 0.3409636616706848),
[2024-12-03 23:55:27,391][flwr][INFO] - 	         (1, 0.3409636616706848),
[2024-12-03 23:55:27,391][flwr][INFO] - 	         (2, 0.3409636616706848),
[2024-12-03 23:55:27,391][flwr][INFO] - 	         (3, 0.3409636616706848),
[2024-12-03 23:55:27,392][flwr][INFO] - 	         (4, 0.3409636616706848),
[2024-12-03 23:55:27,392][flwr][INFO] - 	         (5, 0.3409636616706848),
[2024-12-03 23:55:27,392][flwr][INFO] - 	         (6, 0.3409636616706848),
[2024-12-03 23:55:27,394][flwr][INFO] - 	         (7, 0.3409636616706848),
[2024-12-03 23:55:27,394][flwr][INFO] - 	         (8, 0.3409636616706848),
[2024-12-03 23:55:27,395][flwr][INFO] - 	         (9, 0.3409636616706848),
[2024-12-03 23:55:27,396][flwr][INFO] - 	         (10, 0.3409636616706848)]}
[2024-12-03 23:55:27,397][flwr][INFO] - 
