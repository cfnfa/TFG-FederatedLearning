[2024-12-04 18:56:43,294][flwr][WARNING] - DEPRECATED FEATURE: flwr.simulation.start_simulation() is deprecated.
	Instead, use the `flwr run` CLI command to start a local simulation in your Flower app, as shown for example below:

		$ flwr new  # Create a new Flower app from a template

		$ flwr run  # Run the Flower app in Simulation Mode

	Using `start_simulation()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[2024-12-04 18:56:43,297][flwr][INFO] - Starting Flower simulation, config: num_rounds=10, no round_timeout
[2024-12-04 18:56:51,376][flwr][INFO] - Flower VCE: Ray initialized with resources: {'accelerator_type:G': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'object_store_memory': 1781334835.0, 'node:127.0.0.1': 1.0, 'memory': 3562669671.0, 'GPU': 1.0}
[2024-12-04 18:56:51,377][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-04 18:56:51,377][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0.5}
[2024-12-04 18:56:51,387][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 2 actors
[2024-12-04 18:56:51,387][flwr][INFO] - [INIT]
[2024-12-04 18:56:51,388][flwr][INFO] - Using initial global parameters provided by strategy
[2024-12-04 18:56:51,389][flwr][INFO] - Starting evaluation of initial global parameters
[2024-12-04 18:57:00,986][flwr][INFO] - initial parameters (loss, other metrics): 0.1654050052165985, {'mae': 0.36323487758636475}
[2024-12-04 18:57:00,986][flwr][INFO] - 
[2024-12-04 18:57:00,988][flwr][INFO] - [ROUND 1]
[2024-12-04 18:57:00,989][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:03,470][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:03,478][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:03,484][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:57:11,872][flwr][INFO] - fit progress: (1, 0.1654050052165985, {'mae': 0.36323487758636475}, 10.885218400000003)
[2024-12-04 18:57:11,872][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:13,499][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:13,509][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:13,514][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:57:13,514][flwr][INFO] - 
[2024-12-04 18:57:13,515][flwr][INFO] - [ROUND 2]
[2024-12-04 18:57:13,516][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:14,873][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:14,882][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:14,887][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:57:23,018][flwr][INFO] - fit progress: (2, 0.1654050052165985, {'mae': 0.36323487758636475}, 22.0313586)
[2024-12-04 18:57:23,019][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:24,531][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:24,538][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:24,544][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:57:24,544][flwr][INFO] - 
[2024-12-04 18:57:24,544][flwr][INFO] - [ROUND 3]
[2024-12-04 18:57:24,545][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:25,909][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:25,918][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:25,924][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:57:34,295][flwr][INFO] - fit progress: (3, 0.1654050052165985, {'mae': 0.36323487758636475}, 33.307921699999994)
[2024-12-04 18:57:34,296][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:35,798][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:35,806][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:35,810][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:57:35,810][flwr][INFO] - 
[2024-12-04 18:57:35,810][flwr][INFO] - [ROUND 4]
[2024-12-04 18:57:35,811][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:37,254][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:37,262][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:37,273][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:57:46,177][flwr][INFO] - fit progress: (4, 0.1654050052165985, {'mae': 0.36323487758636475}, 45.190951999999996)
[2024-12-04 18:57:46,179][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:47,544][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:47,551][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:47,556][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:57:47,556][flwr][INFO] - 
[2024-12-04 18:57:47,556][flwr][INFO] - [ROUND 5]
[2024-12-04 18:57:47,557][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:49,139][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:49,147][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:49,151][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:57:57,448][flwr][INFO] - fit progress: (5, 0.1654050052165985, {'mae': 0.36323487758636475}, 56.461579099999994)
[2024-12-04 18:57:57,449][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:57:58,827][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:57:58,834][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:57:58,838][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:57:58,838][flwr][INFO] - 
[2024-12-04 18:57:58,838][flwr][INFO] - [ROUND 6]
[2024-12-04 18:57:58,840][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:00,270][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:00,277][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:00,280][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:58:08,488][flwr][INFO] - fit progress: (6, 0.1654050052165985, {'mae': 0.36323487758636475}, 67.5022407)
[2024-12-04 18:58:08,489][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:09,991][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:09,998][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:10,002][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:58:10,002][flwr][INFO] - 
[2024-12-04 18:58:10,003][flwr][INFO] - [ROUND 7]
[2024-12-04 18:58:10,003][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:11,279][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:11,286][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:11,291][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:58:19,624][flwr][INFO] - fit progress: (7, 0.1654050052165985, {'mae': 0.36323487758636475}, 78.637832)
[2024-12-04 18:58:19,626][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:21,190][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:21,198][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:21,202][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:58:21,203][flwr][INFO] - 
[2024-12-04 18:58:21,203][flwr][INFO] - [ROUND 8]
[2024-12-04 18:58:21,204][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:22,588][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:22,596][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:22,600][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:58:30,735][flwr][INFO] - fit progress: (8, 0.1654050052165985, {'mae': 0.36323487758636475}, 89.7484249)
[2024-12-04 18:58:30,736][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:32,215][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:32,222][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:32,226][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:58:32,226][flwr][INFO] - 
[2024-12-04 18:58:32,226][flwr][INFO] - [ROUND 9]
[2024-12-04 18:58:32,227][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:33,538][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:33,548][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:33,551][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:58:41,809][flwr][INFO] - fit progress: (9, 0.1654050052165985, {'mae': 0.36323487758636475}, 100.8219421)
[2024-12-04 18:58:41,809][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:43,290][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:43,297][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:43,301][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:58:43,302][flwr][INFO] - 
[2024-12-04 18:58:43,302][flwr][INFO] - [ROUND 10]
[2024-12-04 18:58:43,303][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:44,750][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:44,757][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 33, in fit
    self.model.fit(self.x_train, self.y_train, epochs=1, batch_size=32)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:44,761][flwr][INFO] - aggregate_fit: received 0 results and 1 failures
[2024-12-04 18:58:52,984][flwr][INFO] - fit progress: (10, 0.1654050052165985, {'mae': 0.36323487758636475}, 111.9970276)
[2024-12-04 18:58:52,984][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:58:54,352][flwr][ERROR] - Traceback (most recent call last):
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 2753, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\worker.py", line 904, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212

[2024-12-04 18:58:54,359][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\message_handler\message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\client\numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "C:\Users\clara\Desktop\TFG\Codigo TFG\3.FederatedTraining\client.py", line 43, in evaluate
    loss, accuracy = self.model.evaluate(self.x_test, self.y_test)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\keras\src\trainers\data_adapters\data_adapter_utils.py", line 114, in check_data_cardinality
    raise ValueError(msg)
ValueError: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=16264, ip=127.0.0.1, actor_id=4b3ca0b20fc5970be11c966101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001BC827E19A0>)
  File "python\ray\_raylet.pyx", line 1856, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1957, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1862, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1803, in ray._raylet.execute_task.function_executor
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\clara\anaconda3\envs\tf_gpu\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Data cardinality is ambiguous. Make sure all arrays contain the same number of samples.'x' sizes: 16899
'y' sizes: 4212
[2024-12-04 18:58:54,364][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:58:54,364][flwr][INFO] - 
[2024-12-04 18:58:54,364][flwr][INFO] - [SUMMARY]
[2024-12-04 18:58:54,364][flwr][INFO] - Run finished 10 round(s) in 113.38s
[2024-12-04 18:58:54,365][flwr][INFO] - 	History (loss, centralized):
[2024-12-04 18:58:54,365][flwr][INFO] - 		round 0: 0.1654050052165985
[2024-12-04 18:58:54,367][flwr][INFO] - 		round 1: 0.1654050052165985
[2024-12-04 18:58:54,367][flwr][INFO] - 		round 2: 0.1654050052165985
[2024-12-04 18:58:54,367][flwr][INFO] - 		round 3: 0.1654050052165985
[2024-12-04 18:58:54,368][flwr][INFO] - 		round 4: 0.1654050052165985
[2024-12-04 18:58:54,368][flwr][INFO] - 		round 5: 0.1654050052165985
[2024-12-04 18:58:54,368][flwr][INFO] - 		round 6: 0.1654050052165985
[2024-12-04 18:58:54,369][flwr][INFO] - 		round 7: 0.1654050052165985
[2024-12-04 18:58:54,369][flwr][INFO] - 		round 8: 0.1654050052165985
[2024-12-04 18:58:54,369][flwr][INFO] - 		round 9: 0.1654050052165985
[2024-12-04 18:58:54,369][flwr][INFO] - 		round 10: 0.1654050052165985
[2024-12-04 18:58:54,370][flwr][INFO] - 	History (metrics, centralized):
[2024-12-04 18:58:54,370][flwr][INFO] - 	{'mae': [(0, 0.36323487758636475),
[2024-12-04 18:58:54,370][flwr][INFO] - 	         (1, 0.36323487758636475),
[2024-12-04 18:58:54,371][flwr][INFO] - 	         (2, 0.36323487758636475),
[2024-12-04 18:58:54,371][flwr][INFO] - 	         (3, 0.36323487758636475),
[2024-12-04 18:58:54,372][flwr][INFO] - 	         (4, 0.36323487758636475),
[2024-12-04 18:58:54,372][flwr][INFO] - 	         (5, 0.36323487758636475),
[2024-12-04 18:58:54,372][flwr][INFO] - 	         (6, 0.36323487758636475),
[2024-12-04 18:58:54,373][flwr][INFO] - 	         (7, 0.36323487758636475),
[2024-12-04 18:58:54,373][flwr][INFO] - 	         (8, 0.36323487758636475),
[2024-12-04 18:58:54,373][flwr][INFO] - 	         (9, 0.36323487758636475),
[2024-12-04 18:58:54,374][flwr][INFO] - 	         (10, 0.36323487758636475)]}
[2024-12-04 18:58:54,374][flwr][INFO] - 
